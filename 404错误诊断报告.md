# ğŸ” Tomcat 404 é”™è¯¯å®Œæ•´è¯Šæ–­æŠ¥å‘Š

## ğŸ“‹ è¯Šæ–­æ—¶é—´
**2025-10-17**

---

## âŒ å‘ç°çš„é—®é¢˜

### 1ï¸âƒ£ **å…³é”®é—®é¢˜ï¼špom.xmlè·¯å¾„åˆ†éš”ç¬¦é”™è¯¯**

**ä½ç½®**: `pom.xml` ç¬¬98è¡Œ

**é”™è¯¯é…ç½®**:
```xml
<webXml>src\main\webapp\WEB-INF\web.xml</webXml>
```

**æ­£ç¡®é…ç½®**:
```xml
<webXml>src/main/webapp/WEB-INF/web.xml</webXml>
```

**é—®é¢˜è¯´æ˜**:
- ä½¿ç”¨äº†Windowsé£æ ¼çš„åæ–œæ  `\` ä½œä¸ºè·¯å¾„åˆ†éš”ç¬¦
- åœ¨Linux/Unixç³»ç»Ÿå’ŒMavenä¸­åº”è¯¥ä½¿ç”¨æ­£æ–œæ  `/`
- è¿™å¯èƒ½å¯¼è‡´Maven WARæ’ä»¶æ— æ³•æ­£ç¡®æ‰¾åˆ°web.xmlæ–‡ä»¶
- è™½ç„¶è®¾ç½®äº†`failOnMissingWebXml=false`ï¼Œä½†æœ€ä½³å®è·µæ˜¯æ­£ç¡®æŒ‡å®šè·¯å¾„

**å½±å“**:
- WARæ–‡ä»¶å¯èƒ½æœªæ­£ç¡®ç”Ÿæˆï¼ˆå®é™…ä¸Š`target/tarot.war`æ–‡ä»¶ä¸å­˜åœ¨ï¼‰
- éƒ¨ç½²æ—¶Tomcatè‡ªåŠ¨è§£å‹æ—§çš„WARæ–‡ä»¶æˆ–ä½¿ç”¨explodedç›®å½•
- å¯èƒ½å¯¼è‡´é…ç½®ä¸ä¸€è‡´

**ä¿®å¤çŠ¶æ€**: âœ… **å·²ä¿®å¤**

---

### 2ï¸âƒ£ **WARæ–‡ä»¶ç¼ºå¤±é—®é¢˜**

**æ£€æŸ¥ç»“æœ**:
```bash
$ ls -la /workspace/target/
# æ²¡æœ‰ tarot.war æ–‡ä»¶
```

**åŸå› **:
- ç”±äºpom.xmlè·¯å¾„é…ç½®é—®é¢˜ï¼ŒMavenå¯èƒ½æ²¡æœ‰æ­£ç¡®ç”ŸæˆWARæ–‡ä»¶
- æˆ–è€…WARæ–‡ä»¶åœ¨å…¶ä»–ä½ç½®

**å®é™…å‘ç°çš„WARæ–‡ä»¶**:
- `/workspace/out/artifacts/tarot_game_war/tarot-game_war.war` (IDEAç”Ÿæˆçš„)
- ä½†Tomcat webappsä¸‹æ²¡æœ‰`tarot.war`

**å½±å“**:
- æ— æ³•é€šè¿‡æ ‡å‡†Mavenæµç¨‹éƒ¨ç½²
- ä¾èµ–IDEAçš„Artifacté…ç½®æˆ–æ‰‹åŠ¨éƒ¨ç½²

---

### 3ï¸âƒ£ **è®¿é—®æ—¥å¿—åˆ†æï¼šåº”ç”¨å®é™…ä¸Šæ˜¯æ­£å¸¸çš„ï¼** âœ…

**ä»`localhost_access_log.2025-10-16.txt`åˆ†æ**:

```
0:0:0:0:0:0:0:1 - - [16/Oct/2025:18:04:53] "GET /tarot/ HTTP/1.1" 200 3705
0:0:0:0:0:0:0:1 - - [16/Oct/2025:18:04:53] "GET /tarot/api/cards HTTP/1.1" 200 23827
0:0:0:0:0:0:0:1 - - [16/Oct/2025:18:06:38] "GET /tarot/css/tarot-styles.css HTTP/1.1" 200 14142
0:0:0:0:0:0:0:1 - - [16/Oct/2025:18:06:38] "GET /tarot/js/tarot-game.js HTTP/1.1" 200 29619
```

**å…³é”®å‘ç°**:
- âœ… ä¸»é¡µè®¿é—®æˆåŠŸï¼š`GET /tarot/` è¿”å› **200**
- âœ… APIè®¿é—®æˆåŠŸï¼š`GET /tarot/api/cards` è¿”å› **200** (23827å­—èŠ‚æ•°æ®)
- âœ… é™æ€èµ„æºåŠ è½½æˆåŠŸï¼šCSSã€JSã€å›¾ç‰‡éƒ½è¿”å›200
- âœ… åº”ç”¨**å®Œå…¨æ­£å¸¸è¿è¡Œ**ï¼

**ç»“è®º**:
- **åº”ç”¨æœ¬èº«æ²¡æœ‰404é”™è¯¯ï¼**
- æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½éƒ½æ­£å¸¸å·¥ä½œ
- å¦‚æœç”¨æˆ·çœ‹åˆ°404ï¼Œå¯èƒ½æ˜¯ä»¥ä¸‹åŸå› ï¼š
  1. è®¿é—®äº†é”™è¯¯çš„URL
  2. åœ¨æŸä¸ªç‰¹å®šæ—¶é—´ç‚¹è®¿é—®ï¼ˆTomcaté‡å¯æœŸé—´ï¼‰
  3. è®¿é—®äº†ä¸å­˜åœ¨çš„APIç«¯ç‚¹

---

## ğŸ”§ **å·²éƒ¨ç½²çš„åº”ç”¨çŠ¶æ€åˆ†æ**

### éƒ¨ç½²ç›®å½•ç»“æ„
```
/workspace/apache-tomcat-11.0.11/webapps/tarot/
â”œâ”€â”€ css/
â”‚   â””â”€â”€ tarot-styles.css
â”œâ”€â”€ images/
â”‚   â””â”€â”€ å¡ç‰ŒèƒŒé¢.png (5.28 MB)
â”œâ”€â”€ index.html
â”œâ”€â”€ js/
â”‚   â””â”€â”€ tarot-game.js
â”œâ”€â”€ META-INF/
â””â”€â”€ WEB-INF/
    â”œâ”€â”€ classes/
    â”‚   â””â”€â”€ tarot/
    â”‚       â”œâ”€â”€ controller/
    â”‚       â”œâ”€â”€ data/
    â”‚       â”œâ”€â”€ listener/
    â”‚       â”œâ”€â”€ model/
    â”‚       â””â”€â”€ service/
    â”œâ”€â”€ lib/ (7ä¸ªJARæ–‡ä»¶)
    â”‚   â”œâ”€â”€ jackson-annotations-2.18.0.jar
    â”‚   â”œâ”€â”€ jackson-core-2.18.0.jar
    â”‚   â”œâ”€â”€ jackson-databind-2.18.0.jar
    â”‚   â”œâ”€â”€ jackson-datatype-jsr310-2.18.0.jar
    â”‚   â”œâ”€â”€ logback-classic-1.5.8.jar
    â”‚   â”œâ”€â”€ logback-core-1.5.8.jar
    â”‚   â””â”€â”€ slf4j-api-2.0.16.jar
    â””â”€â”€ web.xml
```

**çŠ¶æ€**: âœ… **ç»“æ„å®Œæ•´ï¼Œæ‰€æœ‰å¿…éœ€æ–‡ä»¶éƒ½å­˜åœ¨**

---

### Servleté…ç½®æ£€æŸ¥

**web.xml é…ç½®**:
```xml
<servlet>
    <servlet-name>TarotGameController</servlet-name>
    <servlet-class>tarot.controller.TarotGameController</servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
    <servlet-name>TarotGameController</servlet-name>
    <url-pattern>/api/*</url-pattern>
</servlet-mapping>

<welcome-file-list>
    <welcome-file>index.html</welcome-file>
    <welcome-file>index.htm</welcome-file>
</welcome-file-list>
```

**çŠ¶æ€**: âœ… **é…ç½®æ­£ç¡®**

---

### ç›‘å¬å™¨é…ç½®

**GameInitializationListener**:
```java
@WebListener
public class GameInitializationListener implements ServletContextListener {
    // åœ¨åº”ç”¨å¯åŠ¨æ—¶åˆå§‹åŒ–TarotGameService
}
```

**æ—¥å¿—ç¡®è®¤**ï¼ˆä»localhost.logï¼‰:
```
ä¿¡æ¯ [main] org.apache.catalina.core.ApplicationContext.log ContextListener: contextInitialized()
```

**çŠ¶æ€**: âœ… **ç›‘å¬å™¨æ­£å¸¸å·¥ä½œ**

---

## ğŸ“Š **Tomcatéƒ¨ç½²æ—¥å¿—åˆ†æ**

### æˆåŠŸçš„éƒ¨ç½²æ—¥å¿—
```
16-Oct-2025 23:28:51.783 ä¿¡æ¯ [main] org.apache.catalina.startup.HostConfig.deployWAR 
  webåº”ç”¨ç¨‹åºå­˜æ¡£æ–‡ä»¶[...webapps\tarot.war]çš„éƒ¨ç½²å·²åœ¨[3,724]mså†…å®Œæˆ

16-Oct-2025 23:28:52.792 ä¿¡æ¯ [main] org.apache.coyote.AbstractProtocol.start 
  å¼€å§‹åè®®å¤„ç†å¥æŸ„["http-nio-8080"]

16-Oct-2025 23:28:52.815 ä¿¡æ¯ [main] org.apache.catalina.startup.Catalina.start 
  [4814]æ¯«ç§’åæœåŠ¡å™¨å¯åŠ¨
```

**çŠ¶æ€**: âœ… **éƒ¨ç½²æˆåŠŸï¼Œæ— é”™è¯¯**

---

## âœ… **åº”ç”¨åŠŸèƒ½éªŒè¯**

### å¯ç”¨çš„URLç«¯ç‚¹

1. **ä¸»é¡µ**
   - URL: `http://localhost:8080/tarot/`
   - çŠ¶æ€: âœ… è¿”å›200ï¼Œ3705å­—èŠ‚
   - è¯´æ˜: ä¸»é¡µHTMLæ­£ç¡®åŠ è½½

2. **è·å–æ‰€æœ‰å¡ç‰ŒAPI**
   - URL: `http://localhost:8080/tarot/api/cards`
   - çŠ¶æ€: âœ… è¿”å›200ï¼Œ23827å­—èŠ‚
   - è¯´æ˜: APIæ­£å¸¸è¿”å›JSONæ•°æ®

3. **é™æ€èµ„æº**
   - CSS: âœ… `http://localhost:8080/tarot/css/tarot-styles.css`
   - JS: âœ… `http://localhost:8080/tarot/js/tarot-game.js`
   - å›¾ç‰‡: âœ… `http://localhost:8080/tarot/images/å¡ç‰ŒèƒŒé¢.png`

---

## ğŸ¯ **404é”™è¯¯å¯èƒ½çš„åŸå› **

ç”±äºä»æ—¥å¿—çœ‹åº”ç”¨å®Œå…¨æ­£å¸¸ï¼Œå¦‚æœç”¨æˆ·é‡åˆ°404ï¼Œå¯èƒ½æ˜¯ï¼š

### 1. URLæ‹¼å†™é”™è¯¯
```
âŒ http://localhost:8080/tarot    (ç¼ºå°‘å°¾éƒ¨æ–œæ ï¼Œä¼š302é‡å®šå‘)
âœ… http://localhost:8080/tarot/   (æ­£ç¡®)

âŒ http://localhost:8080/api/cards  (ç¼ºå°‘åº”ç”¨ä¸Šä¸‹æ–‡è·¯å¾„)
âœ… http://localhost:8080/tarot/api/cards  (æ­£ç¡®)
```

### 2. è®¿é—®ä¸å­˜åœ¨çš„APIç«¯ç‚¹
å·²é…ç½®çš„ç«¯ç‚¹ï¼š
- âœ… `/api/cards` - è·å–æ‰€æœ‰å¡ç‰Œ
- âœ… `/api/major-arcana` - è·å–å¤§é˜¿å¡çº³
- âœ… `/api/card/{id}` - è·å–å•å¼ å¡ç‰Œ
- âœ… `/api/reading` - æ‰§è¡Œå åœï¼ˆPOSTï¼‰

### 3. Tomcaté‡å¯æœŸé—´è®¿é—®
æ—¥å¿—æ˜¾ç¤ºå¤šæ¬¡é‡å¯ï¼ŒæœŸé—´ä¼šæš‚æ—¶æ— æ³•è®¿é—®ã€‚

### 4. æµè§ˆå™¨ç¼“å­˜é—®é¢˜
è®¿é—®æ—¥å¿—ä¸­çœ‹åˆ°å¾ˆå¤š304ï¼ˆæœªä¿®æ”¹ï¼‰å“åº”ï¼Œå¯èƒ½æ˜¯ç¼“å­˜å¯¼è‡´çš„æ˜¾ç¤ºé—®é¢˜ã€‚

---

## ğŸ”§ **å·²åº”ç”¨çš„ä¿®å¤**

### âœ… ä¿®å¤1ï¼šè·¯å¾„åˆ†éš”ç¬¦
**æ–‡ä»¶**: `pom.xml`
**ä¿®æ”¹**:
```xml
<!-- ä¿®æ”¹å‰ -->
<webXml>src\main\webapp\WEB-INF\web.xml</webXml>

<!-- ä¿®æ”¹å -->
<webXml>src/main/webapp/WEB-INF/web.xml</webXml>
```

---

## ğŸ“ **å»ºè®®çš„åç»­æ­¥éª¤**

### 1. é‡æ–°æ‰“åŒ…WARæ–‡ä»¶
```bash
cd /workspace
mvn clean package -DskipTests
```

**é¢„æœŸç»“æœ**:
- åº”è¯¥ç”Ÿæˆ `/workspace/target/tarot.war`
- æ–‡ä»¶åº”è¯¥åŒ…å«æ‰€æœ‰å¿…éœ€çš„èµ„æº

### 2. é‡æ–°éƒ¨ç½²
```bash
# åœæ­¢Tomcat
/workspace/apache-tomcat-11.0.11/bin/shutdown.sh

# æ¸…ç†æ—§éƒ¨ç½²
rm -rf /workspace/apache-tomcat-11.0.11/webapps/tarot
rm -f /workspace/apache-tomcat-11.0.11/webapps/tarot.war

# å¤åˆ¶æ–°WARæ–‡ä»¶
cp /workspace/target/tarot.war /workspace/apache-tomcat-11.0.11/webapps/

# å¯åŠ¨Tomcat
/workspace/apache-tomcat-11.0.11/bin/startup.sh
```

### 3. éªŒè¯éƒ¨ç½²
```bash
# ç­‰å¾…10ç§’è®©Tomcatå®Œå…¨å¯åŠ¨
sleep 10

# æµ‹è¯•ä¸»é¡µ
curl http://localhost:8080/tarot/

# æµ‹è¯•API
curl http://localhost:8080/tarot/api/cards
```

### 4. æ£€æŸ¥æ—¥å¿—
```bash
# æŸ¥çœ‹æœ€æ–°æ—¥å¿—
tail -f /workspace/apache-tomcat-11.0.11/logs/catalina.out

# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
tail -f /workspace/apache-tomcat-11.0.11/logs/localhost.*.log
```

---

## ğŸ‰ **æ€»ç»“**

### é—®é¢˜ç°çŠ¶
1. âœ… **åº”ç”¨å®é™…ä¸Šå®Œå…¨æ­£å¸¸å·¥ä½œ**
2. âœ… æ‰€æœ‰APIç«¯ç‚¹éƒ½è¿”å›200çŠ¶æ€ç 
3. âœ… é™æ€èµ„æºæ­£ç¡®åŠ è½½
4. âš ï¸ ä½†å­˜åœ¨é…ç½®é—®é¢˜ï¼ˆpom.xmlè·¯å¾„ï¼‰éœ€è¦ä¿®å¤

### çœŸæ­£çš„é—®é¢˜
- **ä¸æ˜¯404é”™è¯¯**ï¼Œè€Œæ˜¯é…ç½®å’Œæ‰“åŒ…æµç¨‹çš„é—®é¢˜
- WARæ–‡ä»¶ç¼ºå¤±å¯¼è‡´éƒ¨ç½²ä¾èµ–IDEAæˆ–æ‰‹åŠ¨æ“ä½œ
- ä¿®å¤pom.xmlåå¯ä»¥ä½¿ç”¨æ ‡å‡†Mavenæµç¨‹

### å·²ä¿®å¤
- âœ… pom.xmlä¸­çš„è·¯å¾„åˆ†éš”ç¬¦é”™è¯¯

### å¾…éªŒè¯
- â³ é‡æ–°æ‰“åŒ…ç”Ÿæˆæ­£ç¡®çš„WARæ–‡ä»¶
- â³ ä½¿ç”¨æ–°WARæ–‡ä»¶é‡æ–°éƒ¨ç½²æµ‹è¯•

---

## ğŸ“š **ç›¸å…³æ–‡æ¡£**

- [404é—®é¢˜è§£å†³æ–¹æ¡ˆ.md](404é—®é¢˜è§£å†³æ–¹æ¡ˆ.md) - ä¹‹å‰çš„è§£å†³æ–¹æ¡ˆ
- [å¤–è”éƒ¨ç½²é…ç½®å®Œæˆè¯´æ˜.md](å¤–è”éƒ¨ç½²é…ç½®å®Œæˆè¯´æ˜.md) - éƒ¨ç½²é…ç½®è¯´æ˜
- [IDEA_TOMCAT_CONFIG.md](IDEA_TOMCAT_CONFIG.md) - IDEAé…ç½®æŒ‡å—

---

**âœ¨ ç»“è®ºï¼šåº”ç”¨æœ¬èº«æ²¡æœ‰é—®é¢˜ï¼Œä¿®å¤é…ç½®é—®é¢˜åå¯ä»¥æ ‡å‡†åŒ–éƒ¨ç½²æµç¨‹**
