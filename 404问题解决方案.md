# ğŸ” HTTP 404 é—®é¢˜è¯Šæ–­ä¸è§£å†³æ–¹æ¡ˆ

## ğŸ“Š é—®é¢˜ç°è±¡

è®¿é—® `http://localhost:8080/tarot/` æ—¶å‡ºç° **HTTP 404 - æœªæ‰¾åˆ°** é”™è¯¯ã€‚

---

## ğŸ¯ é—®é¢˜æ ¹æº

### âŒ ä¸»è¦é—®é¢˜ï¼š`src/main/webapp/WEB-INF/lib` ç›®å½•åŒ…å« Tomcat jar åŒ…

**å‘ç°è¿‡ç¨‹**ï¼š

1. æ£€æŸ¥ `target/tarot/WEB-INF/lib` å‘ç°åŒ…å« 47 ä¸ª jar åŒ…
2. è¿™äº› jar åŒ…åŒ…æ‹¬ï¼š
    - `catalina.jar`
    - `tomcat-*.jar`
    - `servlet-api.jar`
    - ç­‰å¤§é‡ Tomcat å†…éƒ¨ jar åŒ…

**é—®é¢˜åŸå› **ï¼š

-   Maven æ‰“åŒ… WAR æ—¶ï¼Œä¼šå°† `src/main/webapp/WEB-INF/lib` ä¸‹çš„æ‰€æœ‰ jar åŒ…æ‰“åŒ…è¿›å»
-   è¿™äº› Tomcat jar åŒ…ä¸å¤–éƒ¨ Tomcat æœåŠ¡å™¨çš„ jar åŒ…äº§ç”Ÿ**ç±»åŠ è½½å†²çª**
-   å¯¼è‡´åº”ç”¨æ— æ³•æ­£å¸¸å¯åŠ¨ï¼Œè¿”å› 404 é”™è¯¯

---

## âœ… è§£å†³æ–¹æ¡ˆ

### 1ï¸âƒ£ åˆ é™¤å†²çªçš„ lib ç›®å½•

```bash
# åˆ é™¤æºä»£ç ä¸­çš„libç›®å½•ï¼ˆå¤–è”Tomcatä¸éœ€è¦ï¼‰
Remove-Item -Recurse -Force src\main\webapp\WEB-INF\lib
```

**åŸç†**ï¼š

-   å¤–è” Tomcat éƒ¨ç½²æ—¶ï¼ŒTomcat ä¼šè‡ªåŠ¨æä¾›æ‰€æœ‰è¿è¡Œæ—¶ä¾èµ–
-   `WEB-INF/lib` åº”è¯¥åªåŒ…å«**åº”ç”¨ç‰¹å®šçš„ä¾èµ–**ï¼ˆå¦‚ Jacksonã€Logbackï¼‰
-   Maven ä¼šæ ¹æ® `pom.xml` è‡ªåŠ¨å°†è¿™äº›ä¾èµ–æ‰“åŒ…åˆ° WAR ä¸­

### 2ï¸âƒ£ åˆ é™¤ IDEA çš„ lib åº“é…ç½®

```bash
# åˆ é™¤IDEAé…ç½®æ–‡ä»¶
delete .idea/libraries/lib.xml
```

**lib.xml å†…å®¹**ï¼ˆé—®é¢˜é…ç½®ï¼‰ï¼š

```xml
<library name="lib">
  <CLASSES>
    <root url="file://$PROJECT_DIR$/src/main/webapp/WEB-INF/lib" />
  </CLASSES>
</library>
```

### 3ï¸âƒ£ é‡æ–°æ‰“åŒ…éƒ¨ç½²

```bash
# æ¸…ç†å¹¶é‡æ–°æ‰“åŒ…
mvn clean package -DskipTests

# éƒ¨ç½²åˆ°Tomcat
copy target\tarot.war apache-tomcat-11.0.11\webapps\
```

---

## ğŸ“¦ æ­£ç¡®çš„ WAR åŒ…ç»“æ„

### âœ… ä¿®å¤åçš„ lib ç›®å½•ï¼ˆåªæœ‰ 7 ä¸ª jarï¼‰

```
target/tarot/WEB-INF/lib/
â”œâ”€â”€ jackson-annotations-2.18.0.jar      # JSONå¤„ç†
â”œâ”€â”€ jackson-core-2.18.0.jar             # JSONå¤„ç†
â”œâ”€â”€ jackson-databind-2.18.0.jar         # JSONå¤„ç†
â”œâ”€â”€ jackson-datatype-jsr310-2.18.0.jar  # Java 8æ—¥æœŸæ”¯æŒ
â”œâ”€â”€ logback-classic-1.5.8.jar           # æ—¥å¿—æ¡†æ¶
â”œâ”€â”€ logback-core-1.5.8.jar              # æ—¥å¿—æ¡†æ¶
â””â”€â”€ slf4j-api-2.0.16.jar                # æ—¥å¿—æ¥å£
```

### âŒ ä¿®å¤å‰çš„ lib ç›®å½•ï¼ˆ47 ä¸ª jar - é”™è¯¯ï¼ï¼‰

åŒ…å«äº†ä¸åº”è¯¥å­˜åœ¨çš„ jar åŒ…ï¼š

-   `catalina.jar`, `catalina-ant.jar`, `catalina-ha.jar`
-   `tomcat-embed-*.jar`ï¼ˆåµŒå…¥å¼ Tomcat ç›¸å…³ï¼‰
-   `servlet-api.jar`ï¼ˆåº”ç”± Tomcat æä¾›ï¼‰
-   ç­‰ç­‰...

---

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### Jakarta EE ä¸ OpenJDK 25 å…¼å®¹æ€§

âœ… **å®Œå…¨å…¼å®¹**

| ç»„ä»¶                | ç‰ˆæœ¬    | å…¼å®¹æ€§                |
| ------------------- | ------- | --------------------- |
| Jakarta Servlet API | 6.1.0   | âœ… æ”¯æŒ               |
| Apache Tomcat       | 11.0.11 | âœ… æ”¯æŒ Jakarta EE 10 |
| OpenJDK             | 25      | âœ… å®Œå…¨æ”¯æŒ           |
| Jackson             | 2.18.0  | âœ… æ”¯æŒ               |

**Tomcat 11.0.11 è¯´æ˜**ï¼š

-   å®ç° Jakarta Servlet 6.0 è§„èŒƒ
-   éœ€è¦ Java 17 æˆ–æ›´é«˜ç‰ˆæœ¬
-   **å®Œå…¨æ”¯æŒ OpenJDK 25**

### ç±»åŠ è½½å†²çªåŸç†

```
Tomcatç±»åŠ è½½å™¨å±‚æ¬¡:
    Bootstrap ClassLoader
           â†“
    System ClassLoader
           â†“
    Common ClassLoader (Tomcat/lib/*.jar)
           â†“
    WebApp ClassLoader (WEB-INF/lib/*.jar)
```

**å†²çªåœºæ™¯**ï¼š

1. `WEB-INF/lib` åŒ…å« `servlet-api.jar`
2. Tomcat/lib ä¹ŸåŒ…å« `servlet-api.jar`
3. WebApp ClassLoader ä¼˜å…ˆåŠ è½½è‡ªå·±çš„ç‰ˆæœ¬
4. ä½†å®é™…è¿è¡Œæ—¶éœ€è¦ä¸ Tomcat çš„ç‰ˆæœ¬ä¸€è‡´
5. **ç»“æœï¼šç±»åŠ è½½å†²çª â†’ åº”ç”¨æ— æ³•å¯åŠ¨ â†’ 404 é”™è¯¯**

---

## ğŸ¯ ä¾èµ–ç®¡ç†æœ€ä½³å®è·µ

### pom.xml é…ç½®è¦ç‚¹

```xml
<dependencies>
    <!-- Servlet API - å¤–éƒ¨Tomcatæä¾› -->
    <dependency>
        <groupId>jakarta.servlet</groupId>
        <artifactId>jakarta.servlet-api</artifactId>
        <version>6.1.0</version>
        <scope>provided</scope>  <!-- â­ å…³é”®ï¼šprovided scope -->
    </dependency>

    <!-- åº”ç”¨ç‰¹å®šä¾èµ– - compile scope -->
    <dependency>
        <groupId>com.fasterxml.jackson.core</groupId>
        <artifactId>jackson-databind</artifactId>
        <version>2.18.0</version>
        <scope>compile</scope>  <!-- â­ ä¼šæ‰“åŒ…è¿›WAR -->
    </dependency>
</dependencies>
```

**scope è¯´æ˜**ï¼š

-   `provided`ï¼šç¼–è¯‘æ—¶éœ€è¦ï¼Œè¿è¡Œæ—¶ç”±å®¹å™¨æä¾›ï¼ˆä¸æ‰“åŒ…è¿› WARï¼‰
-   `compile`ï¼šç¼–è¯‘å’Œè¿è¡Œæ—¶éƒ½éœ€è¦ï¼ˆæ‰“åŒ…è¿› WAR çš„ WEB-INF/libï¼‰
-   `test`ï¼šä»…æµ‹è¯•æ—¶éœ€è¦ï¼ˆä¸æ‰“åŒ…ï¼‰

---

## ğŸ“ éªŒè¯æ¸…å•

### âœ… éƒ¨ç½²å‰æ£€æŸ¥

-   [ ] `src/main/webapp/WEB-INF/lib` ç›®å½•ä¸å­˜åœ¨
-   [ ] `mvn dependency:tree` ä¸åŒ…å«åµŒå…¥å¼ Tomcat ä¾èµ–
-   [ ] `target/tarot/WEB-INF/lib` åªåŒ…å«åº”ç”¨ç‰¹å®š jar åŒ…
-   [ ] `pom.xml` ä¸­ Servlet API çš„ scope ä¸º`provided`

### âœ… éƒ¨ç½²åæ£€æŸ¥

```bash
# 1. æ£€æŸ¥Tomcatæ—¥å¿—
Get-Content apache-tomcat-11.0.11\logs\catalina.*.log -Tail 50

# æœŸæœ›çœ‹åˆ°ï¼š
# "webåº”ç”¨ç¨‹åºå­˜æ¡£æ–‡ä»¶[...tarot.war]çš„éƒ¨ç½²å·²åœ¨[xxxx]mså†…å®Œæˆ"

# 2. æ£€æŸ¥éƒ¨ç½²ç›®å½•
dir apache-tomcat-11.0.11\webapps\tarot\WEB-INF\lib

# æœŸæœ›ï¼šåªæœ‰7ä¸ªjaråŒ…ï¼ˆJacksonã€Logbackã€SLF4Jï¼‰

# 3. è®¿é—®æµ‹è¯•
# http://localhost:8080/tarot/
# http://localhost:8080/tarot/api/cards
```

---

## ğŸš€ ç°åœ¨åº”è¯¥å¯ä»¥æ­£å¸¸è®¿é—®äº†ï¼

### æµ‹è¯• URL

-   âœ… ä¸»é¡µï¼šhttp://localhost:8080/tarot/
-   âœ… APIï¼šhttp://localhost:8080/tarot/api/cards
-   âœ… å¤§é˜¿å¡çº³ï¼šhttp://localhost:8080/tarot/api/major-arcana

### æœŸæœ›ç»“æœ

1. **ä¸»é¡µ** æ˜¾ç¤ºå¡”ç½—ç‰Œæ¸¸æˆç•Œé¢
2. **API** è¿”å› JSON æ ¼å¼çš„å¡ç‰Œæ•°æ®
3. **æ²¡æœ‰ 404 é”™è¯¯**

---

## ğŸ” åç»­æ’æŸ¥ï¼ˆå¦‚æœä»æœ‰é—®é¢˜ï¼‰

### æ£€æŸ¥åº”ç”¨åˆå§‹åŒ–

```bash
# æŸ¥çœ‹å®Œæ•´æ—¥å¿—ï¼Œæ‰¾ApplicationContextåˆå§‹åŒ–é”™è¯¯
Get-Content apache-tomcat-11.0.11\logs\catalina.*.log | Select-String "tarot|ERROR|Exception"
```

### æ£€æŸ¥ Servlet æ˜ å°„

ç¡®è®¤ `web.xml` ä¸­çš„é…ç½®ï¼š

```xml
<servlet-mapping>
    <servlet-name>TarotGameController</servlet-name>
    <url-pattern>/api/*</url-pattern>  <!-- â­ APIè·¯å¾„ -->
</servlet-mapping>

<welcome-file-list>
    <welcome-file>index.html</welcome-file>  <!-- â­ ä¸»é¡µ -->
</welcome-file-list>
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

-   [å¤–è”éƒ¨ç½²é…ç½®å®Œæˆè¯´æ˜.md](å¤–è”éƒ¨ç½²é…ç½®å®Œæˆè¯´æ˜.md)
-   [IDEA_TOMCAT_CONFIG.md](IDEA_TOMCAT_CONFIG.md)
-   [README.md](README.md)

---

**âœ¨ é—®é¢˜å·²è§£å†³ï¼ç°åœ¨æ‚¨çš„åº”ç”¨åº”è¯¥å¯ä»¥æ­£å¸¸è®¿é—®äº†ã€‚**

å¦‚æœ‰å…¶ä»–é—®é¢˜ï¼Œè¯·æ£€æŸ¥ Tomcat æ—¥å¿—ä¸­çš„è¯¦ç»†é”™è¯¯ä¿¡æ¯ã€‚
